{% load static %}
{% load sass_tags %}

<link rel="stylesheet" href="{% sass_src 'deps/css/cart-items.scss' %}" />

<div class="cart-items-container">
  {% if carts %}
    <div class="cart-items-list">
      {% for cart in carts %}
        <div class="cart-item">
          <div class="cart-item-product">
            <h3 class="cart-item-name product-name" data-name-ru="{{ cart.product.name_ru }}" data-name-en="{{ cart.product.name_en }}">{{ cart.product.name_en }}</h3>
          </div>

          <div class="cart-item-controls">
            <div class="quantity-control">
              <button type="button" class="quantity-btn decrement" data-cart-id="{{ cart.id }}" data-cart-change-url="{% url 'cart:cart_change' %}" data-quantity="{{ cart.quantity }}">
                {% csrf_token %}
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
              <input type="text" class="quantity-input number" value="{{ cart.quantity }}" readonly />
              <button type="button" class="quantity-btn increment" data-cart-id="{{ cart.id }}" data-cart-change-url="{% url 'cart:cart_change' %}" data-quantity="{{ cart.quantity }}">
                {% csrf_token %}
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
              </button>
            </div>

            <div class="cart-item-price">
              <span class="price-label">{% if cart.product.discount %}<span data-translate="base_price">Base:</span> ${{ cart.product.price }}{% endif %}</span>
              <span class="price-total">${{ cart.product_price }}</span>
            </div>

            <form action="{% url 'cart:cart_remove' %}" method='POST'>
              <button type="submit" name='cart_id' value='{{ cart.id }}' class="remove-btn remove-from-cart" data-cart-id="{{ cart.id }}" href="">
                {% csrf_token %}
                <img src="{% static 'deps/svg/delete.svg' %}" alt="Remove" width="18" height="18" />
              </button>
            </form>
          </div>
        </div>
      {% endfor %}
    </div>

    <div class="cart-summary">
      <div class="summary-content">
        <div class="summary-text">
          <p class="summary-label">Total Items:</p>
          <p class="summary-quantity"><strong>{{ carts.total_quantity }}</strong></p>
        </div>
        <div class="summary-divider"></div>
        <div class="summary-amount">
          <p class="summary-label">Total Amount:</p>
          <p class="summary-price"><strong>${{ carts.total_price }}</strong></p>
        </div>
      </div>

      {% if not order %}
        <a class="checkout-btn" href="{% url 'orders:create_order' %}">Proceed to Checkout</a>
      {% endif %}
    </div>
  {% else %}
    <div class="empty-cart">
      <p data-translate="cart_is_empty" >Your cart is empty</p>
      <a data-translate="buy_now" href="{% url "catalog:index" 'all' %}" class="continue-shopping-btn">Buy now</a>
    </div>
  {% endif %}
</div>
